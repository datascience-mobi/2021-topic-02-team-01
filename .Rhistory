# Setwd = Set working directory -> sets workspace to given folder path
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/rawdata/rawdata breast GSE27830")
# read in CEL files "/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/rawdata/rawdata breast GSE27830"
data.breast = ReadAffy()
data.breast@cdfName <- "HGU133Plus2_Hs_ENST"
orig=colnames(exprs(data.breast))
new = substr(orig, 1, nchar(orig) - 4)
colnames(exprs(data.breast)) = new
# Save image in different path by first defining new workspace and then saving the data
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/sessions/rda")
save.image(file ="rawdata.breast.rda")
# Quality control of data.breast
## Single chip control
image(data.breast, col=rainbow(100,start=0,end = 0.75)[100:1])
#Chips to exclude from further analysis
## - GSM687021
#GSM687017 - GSM687023 -> 10 chips
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="QC_GSM687021.eps")
#Read in pheno Data
filenames = rownames(pData(data.breast))
samples = substr(filenames, 1, 9)
rownames(pData(data.breast)) =filenames
# normalization
breast.vsnrma <- vsnrma(data.breast)
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/sessions/rda")
save.image(file = "normalized_data.rda")
# MeanSdPlot
meanSdPlot(breast.vsnrma)
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="meanSdPlot_breast_vsnrma_normalized.eps")
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/TRA Daten")
# Import of tra.human.5median
tra.human.5median=read.csv(file="Human_protein_atlas_TRA_5median_genes_annotated.tsv", sep="\t")
#ind=grep("Klk",symbols)
#Kallikreins=symbols[ind]
# Import of tra.human
tra.human=read.csv(file="tra.2014.human.5x.table.tsv", sep="\t")
yo = readr::read_tsv("Human_protein_atlas_TRA_5median_genes_annotated_new.tsv")
# Import of tra.human.roth
tra.human.roth=read.csv(file="tra.2014.human.roth.5x.table.tsv", sep="\t")
# Import of tra.mouse.4301
tra.mouse.4301=read.csv(file="tra.2014.mouse.4301.5x.table.tsv", sep="\t")
# Import of tra.human.gtex
tra.mouse.gtex=read.csv(file="tra.2017.human.gtex.5x.table.tsv", sep="\t")
#Import of tra.mouse and location of Klk
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/TRA Daten")
tra.mouse=read.csv(file="tra.2014.mouse.5x.table.tsv",sep="\t")
ind=grep("^Klk",symbols)
View(tra.human)
View(data.breast)
View(tra.human.5median)
View(tra.human)
View(data.breast)
knitr::opts_chunk$set(echo = TRUE)
library(affy)
library(vsn)
library(AnnotationDbi)
library(hgu133plus2hsenstcdf)
library(hgu133plus2hsenstprobe)
library(hexbin)
# Setwd = Set working directory -> sets workspace to given folder path
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/rawdata/rawdata breast GSE27830")
# read in CEL files
data.breast = ReadAffy()
data.breast@cdfName <- "HGU133Plus2_Hs_ENST"
orig=colnames(exprs(data.breast))
new = substr(orig, 1, nchar(orig) - 4)
colnames(exprs(data.breast)) = new
# Save image in different path by first defining new workspace and then saving the data
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/sessions/rda")
save.image(file ="rawdata.breast.rda")
# Quality control of data.breast
## Single chip control
image(data.breast, col=rainbow(100,start=0,end = 0.75)[100:1])
#Chips to exclude from further analysis
## - GSM687021 since there is a uncommon green sot on the left border
#GSM687017 - GSM687023 -> 10 chips (How do I exclude the GSM687021 chip)
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="QC_GSM687021.eps")
# Read in pheno Data
filenames = rownames(pData(data.breast))
samples = substr(filenames, 1, 9)
rownames(pData(data.breast)) =filenames
# normalization
breast.vsnrma <- vsnrma(data.breast)
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/sessions/rda")
save.image(file = "normalized_data.rda")
# MeanSdPlot
meanSdPlot(breast.vsnrma)
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="meanSdPlot_breast_vsnrma_normalized.eps")
##Boxplot before and after normalization
x11(w=10, h=7)
par(las=2)
par(las=2)
mmi=c(1,0.7,1.0477939,0.5366749)
par(mai=mmi)
boxplot(data.breast, col=rainbow(150),cex.axis=0.5,main="Gene expression in human breast cancer")
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="boxplot_breast_rawdata.eps")
library(affy)
library(vsn)
library(AnnotationDbi)
library(hgu133plus2hsenstcdf)
library(hgu133plus2hsenstprobe)
library(hexbin)
# Setwd = Set working directory -> sets workspace to given folder path
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/rawdata/rawdata breast GSE27830")
# read in CEL files
data.breast = ReadAffy()
data.breast@cdfName <- "HGU133Plus2_Hs_ENST"
orig=colnames(exprs(data.breast))
new = substr(orig, 1, nchar(orig) - 4)
colnames(exprs(data.breast)) = new
# Save image in different path by first defining new workspace and then saving the data
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/sessions/rda")
save.image(file ="rawdata.breast.rda")
# Quality control of data.breast
#-------------------------------
## Single chip control
image(data.breast, col=rainbow(100,start=0,end = 0.75)[100:1])
##Chips to exclude from further analysis
## - GSM687021 since there is a uncommon green sot on the left border
##GSM687017 - GSM687023 -> 10 chips (How do I exclude the GSM687021 chip)
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="QC_GSM687021.eps")
## Read in pheno Data
filenames = rownames(pData(data.breast))
samples = substr(filenames, 1, 9)
rownames(pData(data.breast)) =filenames
## Normalization
breast.vsnrma <- vsnrma(data.breast)
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/sessions/rda")
save.image(file = "normalized_data.rda")
## MeanSdPlot
meanSdPlot(breast.vsnrma)
###The line is approximately horizontal, so there shouldn't be a variance-mean dependence
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="meanSdPlot_breast_vsnrma_normalized.eps")
##Boxplot before normalization
x11(w=10, h=7)
par(las=2)
mmi=c(1,0.7,1.0477939,0.5366749)
par(mai=mmi)
boxplot(data.breast, col=rainbow(150),cex.axis=0.5,main="Gene expression in human breast cancer")
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="boxplot_breast_rawdata.eps")
##Boxplot after normalization
## Normalization
breast.vsnrma <- vsnrma(data.breast)
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/sessions/rda")
save.image(file = "normalized_data.rda")
## MeanSdPlot
meanSdPlot(breast.vsnrma)
###The line is approximately horizontal, so there shouldn't be a variance-mean dependence
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="meanSdPlot_breast_vsnrma_normalized.eps")
##Boxplot before normalization
x11(w=10, h=7)
par(las=2)
mmi=c(1,0.7,1.0477939,0.5366749)
par(mai=mmi)
boxplot(data.breast, col=rainbow(150),cex.axis=0.5,main="Gene expression in human breast cancer")
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="boxplot_breast_rawdata.eps")
##Boxplot after normalization
## MeanSdPlot
meanSdPlot(breast.vsnrma)
## MeanSdPlot
meanSdPlot(breast.vsnrma)
##Boxplot before normalization
x11(w=10, h=7)
par(las=2)
mmi=c(1,0.7,1.0477939,0.5366749)
par(mai=mmi)
boxplot(data.breast, col=rainbow(150),cex.axis=0.5,main="Gene expression in human breast cancer")
knitr::opts_chunk$set(echo = TRUE)
# save normalized version of rawdata before continuing
rawdata.vsnrma <- vsnrma(rawdata)
library(affy)
library(vsn)
library(AnnotationDbi)
library(hgu133plus2hsenstcdf)
library(hgu133plus2hsenstprobe)
library(hexbin)
library(ggplot2)
library(pheatmap)
###here package
library(here)
#set the top level folder with here
here::here()
#creating a list of the CEL file names, for all thre data sets
setwd(here("Rawdata/rawdata breast GSE27830"))
cels.rawdata <- list.files(pattern = 'CEL')
setwd(here("Rawdata/GSE65216 breast cancer TNBC Her2 LumA LumB"))
cels.breast <- list.files(pattern = 'CEL')
setwd(here("Rawdata/GSE149507 lung cancer"))
cels.lung <- list.files(pattern = 'CEL')
#read the CEL files into an Affybatch
#Rawdata
rawdata <- ReadAffy(filenames = paste(here("Rawdata/rawdata breast GSE27830"), cels.rawdata, sep = "/"), verbose = TRUE)
rawdata@cdfName <- "HGU133Plus2_Hs_ENST"
orig.rawdata=colnames(exprs(rawdata))
new.rawdata <- substr(orig.rawdata, 1, nchar(cels.rawdata)-4)
colnames(exprs(rawdata)) <- new.rawdata
rownames(rawdata@phenoData) <- new.rawdata
rownames(rawdata@protocolData) <- new.rawdata
save(rawdata, file = paste0(paste(here("Tables")), "/rawdata.rda"))
#Breast
breast <- ReadAffy(filenames = paste(here("Rawdata/GSE65216 breast cancer TNBC Her2 LumA LumB"), cels.breast, sep = "/"), verbose = TRUE)
breast@cdfName <- "HGU133Plus2_Hs_ENST"
orig.breast=colnames(exprs(breast))
new.breast <- substr(orig.breast, 1, nchar(cels.breast)-4)
colnames(exprs(breast)) <- new.breast
rownames(breast@phenoData) <- new.breast
rownames(breast@protocolData) <- new.breast
save(breast, file = paste0(paste(here("Tables")), "/breast.rda"))
#Lung
lung <- ReadAffy(filenames = paste(here("Rawdata/GSE149507 lung cancer"), cels.lung, sep = "/"), verbose = TRUE)
lung@cdfName <- "HGU133Plus2_Hs_ENST"
orig.lung=colnames(exprs(lung))
new.lung <- substr(orig.lung, 1, nchar(cels.lung)-4)
colnames(exprs(lung)) <- new.lung
rownames(lung@phenoData) <- new.lung
rownames(lung@protocolData) <- new.lung
save(lung, file = paste0(paste(here("Tables")), "/lung.rda"))
# save normalized version of rawdata before continuing
rawdata.vsnrma <- vsnrma(rawdata)
setwd(here("Tables"))
save.image(file = "rawdataNorm.rda")
# read images for GSE65216 breast cancer TNBC Her2 LumA LumB
setwd(here("Plots/Plots_breast_qc"))
pdf("breast_chip_control.pdf")
image(breast, col=rainbow(100,start=0,end = 0.75)[100:1])
dev.off()
# the individual chips look fine
## Normalization
breast.vsnrma <- vsnrma(breast)
setwd(here("Tables"))
save.image(file = "breastNorm.rda")
## MeanSdPlot
setwd(here("Plots/Plots_breast_qc"))
msd.breast <- meanSdPlot(breast.vsnrma)
msd.breast.title <- msd.breast$gg + ggtitle("Mean sd GSE65216 (Maire et al. 2013)")
pdf("breast_meansdPlot.pdf")
print(msd.breast.title)
dev.off()
###The line is approximately horizontal, so there shouldn't be a variance-mean dependence
##Boxplot before normalization
x11(w=10, h=7)
par(las=2)
mmi=c(1,0.7,1.0477939,0.5366749)
par(mai=mmi)
setwd(here("Plots/Plots_breast_qc"))
pdf("breast_box_bfnorm.pdf")
boxplot(breast, horizontal = TRUE , col=rainbow(150),cex.axis=0.38,main="GSE65216 gene expression before normalization", las = 2)
dev.off()
##Boxplot after normalization
x11(w=10, h=7)
par(las=2)
mmi=c(1,0.7,1.0477939,0.5366749)
par(mai=mmi)
pdf("breast_box_afnorm.pdf")
boxplot(exprs(breast.vsnrma),horizontal = TRUE,col=rainbow(150),cex.axis=0.5,main="GSE65216 gene expression after normalization" , las=2)
dev.off()
setwd(here("Tables"))
getwd()
load(file = "rawdataNorm.rda")
setwd(here("Tables"))
load(file = "rawdataNorm.rda")
knitr::opts_chunk$set(echo = TRUE)
library(affy)
library(vsn)
library(AnnotationDbi)
library(hgu133plus2hsenstcdf)
library(hgu133plus2hsenstprobe)
library(hexbin)
library(ggplot2)
library(pheatmap)
###here package
library(here)
#set the top level folder with here
here::here()
#creating a list of the CEL file names, for all thre data sets
setwd(here("Rawdata/rawdata breast GSE27830"))
cels.rawdata <- list.files(pattern = 'CEL')
setwd(here("Rawdata/GSE65216 breast cancer TNBC Her2 LumA LumB"))
cels.breast <- list.files(pattern = 'CEL')
setwd(here("Rawdata/GSE149507 lung cancer"))
cels.lung <- list.files(pattern = 'CEL')
#read the CEL files into an Affybatch
#Rawdata
rawdata <- ReadAffy(filenames = paste(here("Rawdata/rawdata breast GSE27830"), cels.rawdata, sep = "/"), verbose = TRUE)
rawdata@cdfName <- "HGU133Plus2_Hs_ENST"
orig.rawdata=colnames(exprs(rawdata))
new.rawdata <- substr(orig.rawdata, 1, nchar(cels.rawdata)-4)
colnames(exprs(rawdata)) <- new.rawdata
rownames(rawdata@phenoData) <- new.rawdata
rownames(rawdata@protocolData) <- new.rawdata
save(rawdata, file = paste0(paste(here("Tables")), "/rawdata.rda"))
#Breast
breast <- ReadAffy(filenames = paste(here("Rawdata/GSE65216 breast cancer TNBC Her2 LumA LumB"), cels.breast, sep = "/"), verbose = TRUE)
breast@cdfName <- "HGU133Plus2_Hs_ENST"
orig.breast=colnames(exprs(breast))
new.breast <- substr(orig.breast, 1, nchar(cels.breast)-4)
colnames(exprs(breast)) <- new.breast
rownames(breast@phenoData) <- new.breast
rownames(breast@protocolData) <- new.breast
save(breast, file = paste0(paste(here("Tables")), "/breast.rda"))
#Lung
lung <- ReadAffy(filenames = paste(here("Rawdata/GSE149507 lung cancer"), cels.lung, sep = "/"), verbose = TRUE)
lung@cdfName <- "HGU133Plus2_Hs_ENST"
orig.lung=colnames(exprs(lung))
new.lung <- substr(orig.lung, 1, nchar(cels.lung)-4)
colnames(exprs(lung)) <- new.lung
rownames(lung@phenoData) <- new.lung
rownames(lung@protocolData) <- new.lung
save(lung, file = paste0(paste(here("Tables")), "/lung.rda"))
# save normalized version of rawdata before continuing
rawdata.vsnrma <- vsnrma(rawdata)
setwd(here("Tables"))
save.image(file = "rawdataNorm.rda")
breast.vsnrma <- vsnrma(breast)
breast.vsnrma <- vsnrma(breast)
breastExprs = exprs(breast.vsnrma)
lung.vsnrma <- vsnrma(lung)
lungExprs = exprs(lung.vsnrma)
rawdata.vsnrma <- vsnrma(rawdata)
rawdataExprs = exprs(rawdata.vsnrma)
setwd(here("TRA Daten"))
# Import of tra.human.5median
tra.human.5median=read.csv(file="Human_protein_atlas_TRA_5median_genes_annotated.tsv", sep=",")
# Import of tra.human
tra.human=read.csv(file="tra.2014.human.5x.table.tsv", sep="\t")
# Import of tra.human.roth
tra.human.roth=read.csv(file="tra.2014.human.roth.5x.table.tsv", sep="\t")
# Import of tra.mouse.4301
tra.mouse.4301=read.csv(file="tra.2014.mouse.4301.5x.table.tsv", sep="\t")
# Import of tra.human.gtex
tra.mouse.gtex=read.csv(file="tra.2017.human.gtex.5x.table.tsv", sep="\t")
#Import of tra.mouse
tra.mouse=read.csv(file="tra.2014.mouse.5x.table.tsv",sep="\t")
# For tra.human
ind.human=grepl("^KLK",tra.human$gene.symbol)
ind.human =which(ind.human == TRUE)
Klk.TRA1 = as.data.frame(tra.human[ind.human,])
# For tra.human.5median ####DOESNT WORK SINCE CONFLICT DURING IMPORT
ind.5median=grepl("^Klk",tra.human.5median$gene.symbol)
ind.5median =which(ind.5median == TRUE)
Klk.TRA2 = as.data.frame(tra.human.5median[ind.5median,])
# For tra.human.roth
ind.roth=grepl("^KLK",tra.human.roth$gene.symbol)
ind.roth =which(ind.roth == TRUE)
Klk.TRA3 = as.data.frame(tra.human.roth[ind.roth,])
# For tra.mouse
ind.mouse=grepl("^Klk",tra.mouse$gene.symbol)
ind.mouse =which(ind.mouse == TRUE)
Klk.TRA4 = as.data.frame(tra.mouse[ind.mouse,])
# For tra.mouse.4301
ind.4301=grepl("^Klk",tra.mouse.4301$gene.symbol)
ind.4301 =which(ind.4301 == TRUE)
Klk.TRA5 = as.data.frame(tra.mouse.4301[ind.4301,])
# For tra.mouse.gtex ###Here the genes are listed in ensembl.symbol
#-> should rearrange all genes in same columns before putting it all in one data frame
ind.gtex=grepl("^KLK",tra.mouse.gtex$ensembl.symbol)
ind.gtex=which(ind.gtex == TRUE)
Klk.TRA6=as.data.frame(tra.mouse.gtex[ind.gtex,])
setwd(here("Tables"))
ensembl_df = read.csv("ensembl.103.txt",sep="\t")
rawdataExprs <- rawdataExprs[grepl("ENST", rownames(rawdataExprs)), ]
#dim = 95659    10
# remove .x_at suffix
rownames(rawdataExprs) <- unlist(lapply(strsplit(rownames(rawdataExprs), split = "\\."), "[", 1))
setwd(here("Scripts"))
#Setting up annotation
transcriptIDs <- as.character(ensembl_df[, "Transcript.stable.ID"])
geneSymbol <- as.character(ensembl_df[, "HGNC.symbol"])
names(geneSymbol) <- transcriptIDs
# replace ensemble IDs with HGNC symbol
chipIDs <- rownames(rawdataExprs)
noMatchIDs <- chipIDs[!chipIDs %in% transcriptIDs] # transcript IDs that are not in ensemble_103.txt
length(noMatchIDs) #112
newChipIDs <- chipIDs[chipIDs %in% transcriptIDs]
rawdataExprs <- rawdataExprs[newChipIDs, ]
dim(rawdataExprs) ## 95547    10
#
symbol <- geneSymbol[newChipIDs]
rownames(rawdataExprs) <- as.character(symbol)  # Matrix to work with
head(rawdataExprs)
# replace ensemble IDs with HGNC symbol
chipIDs.breast <- rownames(breastExprs)
breastExprs <- breastExprs[grepl("ENST", rownames(breastExprs)), ]
dim(breastExprs) #  95659    20
# remove .x_at suffix
rownames(breastExprs) <- unlist(lapply(strsplit(rownames(breastExprs), split = "\\."), "[", 1))
setwd(here("Scripts"))
# replace ensemble IDs with HGNC symbol
chipIDs.breast <- rownames(breastExprs)
noMatchIDs.breast <- chipIDs.breast[!chipIDs.breast %in% transcriptIDs]
# transcript IDs that are not in ensemble_103.txt
length(noMatchIDs.breast) #112
newChipIDs.breast <- chipIDs.breast[chipIDs.breast %in% transcriptIDs]
breastExprs <- breastExprs[newChipIDs.breast, ]
dim(breastExprs) ## 95547    10
#
symbol.breast <- geneSymbol[newChipIDs.breast]
rownames(breastExprs) <- as.character(symbol.breast)  # Matrix to work with
head(breastExprs)
dim(breastExprs) #  95659    20
lungExprs <- lungExprs[grepl("ENST", rownames(lungExprs)), ]
dim(lungExprs) #  95659    20
# remove .x_at suffix
rownames(lungExprs) <- unlist(lapply(strsplit(rownames(lungExprs), split = "\\."), "[", 1))
setwd(here("Scripts"))
# replace ensemble IDs with HGNC symbol
chipIDs.lung <- rownames(lungExprs)
noMatchIDs.lung <- chipIDs.lung[!chipIDs.lung %in% transcriptIDs]
# transcript IDs that are not in ensemble_103.txt
length(noMatchIDs.lung) #112
newChipIDs.lung <- chipIDs.lung[chipIDs.lung %in% transcriptIDs]
lungExprs <- lungExprs[newChipIDs.lung, ]
dim(lungExprs) ## 95547    10
#
symbol.lung <- geneSymbol[newChipIDs.lung]
rownames(lungExprs) <- as.character(symbol.lung)  # Matrix to work with
head(lungExprs)
# Klk genes in any cancer -> filter after tissue or genes?
## Selecting from the vector symbol genes of Klk
# Tissue in prostate as an example -> Here do the process with combined TRA data set
#But firstly executing it on whole TRA mouse dataset
tiss=tra.human[,11]
ind.prostate=which(tiss=="Prostate")
TRA.symbol=tra.human[,3]
prostate.TRA1=TRA.symbol[ind.prostate]
row.ind.prostate=which(as.character(symbol) %in% prostate.TRA1)
## For rawdata
rawdataExprs.prostate = rawdataExprs[row.ind.prostate,] #How genes in prostate Tissue of human TRAs?
dim(rawdataExprs.prostate) #over the 10 patients there are 151 genes for each
## Prostate matrix -> "KLK", WATCH OUT, do not write "Klk"
## For breast cancer
breastExprs.prostate = breastExprs[row.ind.prostate,] #How genes in prostate Tissue of human TRAs?
dim(breastExprs.prostate)#over the 10 patients there are 151 genes for each
# For lung cancer
lungExprs.prostate = lungExprs[row.ind.prostate,] #How genes in prostate Tissue of human TRAs?
dim(lungExprs.prostate)#over the 10 patients there are 151 genes for each
pheatmap(t(rawdataExprs.prostate))
pheatmap(t(breastExprs.prostate))
pheatmap(t(lungExprs.prostate))
## Now how many KLK genes are TRAs
# Use Klk.TRA1 for this, filtered for Klk genes -> use ind.human
TRA.symbol=tra.human[,3] # lists all TRAs names for humans
KLK.genes.TRA1 = TRA.symbol[ind.human] #ind.human (see chunk 21) filters for KLKs in tra.human
row.ind.klk1=which(as.character(symbol) %in% KLK.genes.TRA1) #row.ind.klk1 gives respective column
# For first breast cancer data set
data.KLK.rawdata = rawdataExprs[row.ind.klk1,]
dim(data.KLK.rawdata) ## 39 KLK genes in breast cancer rawdata
setwd(here("Plots/Plots_raw_breast"))
pdf("KLK_TRAs_Heatmap_rawdata.pdf")
pheatmap(data.KLK.rawdata, main = "Expression values of KLK TRAs in human breast cancer GSE27830 ")
## (Nagel et al. 2012)
dev.off()
# For GSE65216 breast cancer
data.KLK.breast = breastExprs[row.ind.klk1,]
dim(data.KLK.breast) ## 39 KLK genes in breast cancer rawdata
setwd(here("Plots/Plots_breast"))
pdf("KLK_TRAs_Heatmap_breast.pdf")
pheatmap(data.KLK.breast, main = "Expression values of KLK TRAs in human breast cancer GSE65216")
## (Maire et al. 2013)
dev.off()
# For GSE149507 lung cancer
data.KLK.lung = lungExprs[row.ind.klk1,]
dim(data.KLK.lung) ## 39 KLK genes in breast cancer rawdata
setwd(here("Plots/Plots_lung"))
pdf("KLK_TRAs_Heatmap_lung.pdf")
pheatmap(data.KLK.lung, main = "Expression values of KLK TRAs in human lung cancer GSE149507")
## (Cai et al. 2021)
dev.off()
##Anmerkung: Es kommen 39 Einträge für KLK TRAs bei den Cancer Datensätzen
## obwohl nur 38 KLK TRAs sind, das liegt daran dass eine Zeile doppelt ist
## -> das wäre Zeile 1 und 10
length(data.KLK.breast[1,] == data.KLK.breast[10,] )
# expression values identical for all 20 samples :( -> row 10 needs to be deleted
# Maybe delete it out of first data frame
### FOR ALL KLK genes
ind.all.KLK=grep("^KLK",symbol)
Kallikreins=symbol[ind.all.KLK]
###FOR rawdata
all.KLK.rawdata = rawdataExprs[ind.all.KLK,]
### MATRIX data.all.KLK -> all KLK genes in breast cancer
all.KLK.rawdata = t(all.KLK.rawdata)
head(all.KLK.rawdata)
dim(all.KLK.rawdata) #10 112
#112 single KLK genes in breast cancer rawdata
#Lets test out a boxplot
par(las=2)
##Experimental
boxplot(all.KLK.rawdata,col=rainbow(length(rownames(data.KLK.TRA1))),main="gene expression of KLK genes in human breast cancer",cex.axis=0.8)
##Experimental
boxplot(all.KLK.rawdata,col=rainbow(length(rownames(data.KLK.TRA1))),main="gene expression of KLK genes in human breast cancer",cex.axis=0.8)
cels.rawdata <- list.files(pattern = 'CEL')
cels.rawdata
#creating a list of the CEL file names, for all three data sets
setwd(here("Rawdata/rawdata breast GSE27830"))
cels.rawdata <- list.files(pattern = 'CEL')
setwd(here("Rawdata/GSE65216 breast cancer TNBC Her2 LumA LumB"))
cels.breast <- list.files(pattern = 'CEL')
setwd(here("Rawdata/GSE149507 lung cancer"))
cels.lung <- list.files(pattern = 'CEL')
cels.rawdata
cels.breast
cels.lung
