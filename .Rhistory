knitr::opts_chunk$set(echo = TRUE)
here::i_am("02_TissueSpecificAntigens_2021_Klk_1.0.rmd")
#
standardPath <- .libPaths()
newPath <- "C:/.../TRA_project/library"
myPaths <- c(newPath, standardPath)
library(affy, lib.loc = myPaths[2])
library(vsn, lib.loc = myPaths[2])
library(AnnotationDbi, lib.loc = myPaths[2])
library(hgu133plus2hsenstcdf, lib.loc = myPaths[2])
library(hgu133plus2hsenstprobe, lib.loc = myPaths[2])
library(here)
library(ggplot2)
library(tidyverse)
library(hexbin)
# Getting the relative path to set work directory to correct folder
# Setwd = Set working directory -> sets workspace to given folder path
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/rawdata/rawdata breast GSE27830")
# read in CEL files "/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/rawdata/rawdata breast GSE27830"
data.breast = ReadAffy()
data.breast@cdfName <- "HGU133Plus2_Hs_ENST"
orig=colnames(exprs(data.breast))
new = substr(orig, 1, nchar(orig) - 4)
colnames(exprs(data.breast)) = new
# Save image in different path by first defining new workspace and then saving the data
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/sessions/rda")
save.image(file ="rawdata.breast.rda")
# Quality control of data.breast
## Single chip control
image(data.breast, col=rainbow(100,start=0,end = 0.75)[100:1])
#Chips to exclude from further analysis
## - GSM687021
#GSM687017 - GSM687023 -> 10 chips
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="QC_GSM687021.eps")
#Read in pheno Data
filenames = rownames(pData(data.breast))
samples = substr(filenames, 1, 9)
rownames(pData(data.breast)) =filenames
# normalization
breast.vsnrma <- vsnrma(data.breast)
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/sessions/rda")
save.image(file = "normalized_data.rda")
# MeanSdPlot
meanSdPlot(breast.vsnrma)
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="meanSdPlot_breast_vsnrma_normalized.eps")
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/TRA Daten")
# Import of tra.human.5median
tra.human.5median=read.csv(file="Human_protein_atlas_TRA_5median_genes_annotated.tsv", sep="\t")
#ind=grep("Klk",symbols)
#Kallikreins=symbols[ind]
# Import of tra.human
tra.human=read.csv(file="tra.2014.human.5x.table.tsv", sep="\t")
yo = readr::read_tsv("Human_protein_atlas_TRA_5median_genes_annotated_new.tsv")
# Import of tra.human.roth
tra.human.roth=read.csv(file="tra.2014.human.roth.5x.table.tsv", sep="\t")
# Import of tra.mouse.4301
tra.mouse.4301=read.csv(file="tra.2014.mouse.4301.5x.table.tsv", sep="\t")
# Import of tra.human.gtex
tra.mouse.gtex=read.csv(file="tra.2017.human.gtex.5x.table.tsv", sep="\t")
#Import of tra.mouse and location of Klk
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/TRA Daten")
tra.mouse=read.csv(file="tra.2014.mouse.5x.table.tsv",sep="\t")
ind=grep("^Klk",symbols)
View(tra.human)
View(data.breast)
View(tra.human.5median)
View(tra.human)
View(data.breast)
knitr::opts_chunk$set(echo = TRUE)
library(affy)
library(vsn)
library(AnnotationDbi)
library(hgu133plus2hsenstcdf)
library(hgu133plus2hsenstprobe)
library(hexbin)
# Setwd = Set working directory -> sets workspace to given folder path
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/rawdata/rawdata breast GSE27830")
# read in CEL files
data.breast = ReadAffy()
data.breast@cdfName <- "HGU133Plus2_Hs_ENST"
orig=colnames(exprs(data.breast))
new = substr(orig, 1, nchar(orig) - 4)
colnames(exprs(data.breast)) = new
# Save image in different path by first defining new workspace and then saving the data
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/sessions/rda")
save.image(file ="rawdata.breast.rda")
# Quality control of data.breast
## Single chip control
image(data.breast, col=rainbow(100,start=0,end = 0.75)[100:1])
#Chips to exclude from further analysis
## - GSM687021 since there is a uncommon green sot on the left border
#GSM687017 - GSM687023 -> 10 chips (How do I exclude the GSM687021 chip)
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="QC_GSM687021.eps")
# Read in pheno Data
filenames = rownames(pData(data.breast))
samples = substr(filenames, 1, 9)
rownames(pData(data.breast)) =filenames
# normalization
breast.vsnrma <- vsnrma(data.breast)
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/sessions/rda")
save.image(file = "normalized_data.rda")
# MeanSdPlot
meanSdPlot(breast.vsnrma)
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="meanSdPlot_breast_vsnrma_normalized.eps")
##Boxplot before and after normalization
x11(w=10, h=7)
par(las=2)
par(las=2)
mmi=c(1,0.7,1.0477939,0.5366749)
par(mai=mmi)
boxplot(data.breast, col=rainbow(150),cex.axis=0.5,main="Gene expression in human breast cancer")
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="boxplot_breast_rawdata.eps")
library(affy)
library(vsn)
library(AnnotationDbi)
library(hgu133plus2hsenstcdf)
library(hgu133plus2hsenstprobe)
library(hexbin)
# Setwd = Set working directory -> sets workspace to given folder path
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/rawdata/rawdata breast GSE27830")
# read in CEL files
data.breast = ReadAffy()
data.breast@cdfName <- "HGU133Plus2_Hs_ENST"
orig=colnames(exprs(data.breast))
new = substr(orig, 1, nchar(orig) - 4)
colnames(exprs(data.breast)) = new
# Save image in different path by first defining new workspace and then saving the data
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/sessions/rda")
save.image(file ="rawdata.breast.rda")
# Quality control of data.breast
#-------------------------------
## Single chip control
image(data.breast, col=rainbow(100,start=0,end = 0.75)[100:1])
##Chips to exclude from further analysis
## - GSM687021 since there is a uncommon green sot on the left border
##GSM687017 - GSM687023 -> 10 chips (How do I exclude the GSM687021 chip)
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="QC_GSM687021.eps")
## Read in pheno Data
filenames = rownames(pData(data.breast))
samples = substr(filenames, 1, 9)
rownames(pData(data.breast)) =filenames
## Normalization
breast.vsnrma <- vsnrma(data.breast)
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/sessions/rda")
save.image(file = "normalized_data.rda")
## MeanSdPlot
meanSdPlot(breast.vsnrma)
###The line is approximately horizontal, so there shouldn't be a variance-mean dependence
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="meanSdPlot_breast_vsnrma_normalized.eps")
##Boxplot before normalization
x11(w=10, h=7)
par(las=2)
mmi=c(1,0.7,1.0477939,0.5366749)
par(mai=mmi)
boxplot(data.breast, col=rainbow(150),cex.axis=0.5,main="Gene expression in human breast cancer")
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="boxplot_breast_rawdata.eps")
##Boxplot after normalization
## Normalization
breast.vsnrma <- vsnrma(data.breast)
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/sessions/rda")
save.image(file = "normalized_data.rda")
## MeanSdPlot
meanSdPlot(breast.vsnrma)
###The line is approximately horizontal, so there shouldn't be a variance-mean dependence
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="meanSdPlot_breast_vsnrma_normalized.eps")
##Boxplot before normalization
x11(w=10, h=7)
par(las=2)
mmi=c(1,0.7,1.0477939,0.5366749)
par(mai=mmi)
boxplot(data.breast, col=rainbow(150),cex.axis=0.5,main="Gene expression in human breast cancer")
setwd("/Users/Dusti/Documents/Studium/Bioinfo/Data_Analysis/Bioinformatik TRA Projekt/The role of Klk in cancer/plots")
dev.copy2eps(file="boxplot_breast_rawdata.eps")
##Boxplot after normalization
## MeanSdPlot
meanSdPlot(breast.vsnrma)
## MeanSdPlot
meanSdPlot(breast.vsnrma)
##Boxplot before normalization
x11(w=10, h=7)
par(las=2)
mmi=c(1,0.7,1.0477939,0.5366749)
par(mai=mmi)
boxplot(data.breast, col=rainbow(150),cex.axis=0.5,main="Gene expression in human breast cancer")
